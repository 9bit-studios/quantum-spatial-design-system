<svg width="{{size}}" height="{{size}}" viewBox="0 0 {{size}} {{size}}" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <filter id="glow-superposition" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="{{glowIntensity}}" result="blur"/>
      <feComposite in="SourceGraphic" in2="blur" operator="over"/>
    </filter>
    <filter id="displace" x="-20%" y="-20%" width="140%" height="140%">
      <feTurbulence type="turbulence" baseFrequency="0.03" numOctaves="2" result="turbulence">
        <animate attributeName="baseFrequency" from="0.03" to="0.05" dur="10s" repeatCount="indefinite"/>
      </feTurbulence>
      <feDisplacementMap in="SourceGraphic" in2="turbulence" scale="3" xChannelSelector="R" yChannelSelector="G"/>
    </filter>
    <linearGradient id="superpositionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="{{accentColor}}" stop-opacity="0.3"/>
      <stop offset="50%" stop-color="{{color}}" stop-opacity="0.7"/>
      <stop offset="100%" stop-color="{{secondaryAccentColor}}" stop-opacity="0.3"/>
    </linearGradient>
  </defs>
  
  <!-- Layer 3 (background layer) -->
  <rect
    x="{{layer3Offset}}"
    y="{{layer3Offset}}"
    width="{{layer3Size}}"
    height="{{layer3Size}}"
    rx="{{borderRadius}}"
    fill="{{secondaryAccentColor}}"
    opacity="0.2"
    class="superposition-layer3"
  />
  
  <!-- Layer 2 (middle layer) -->
  <rect
    x="{{layer2Offset}}"
    y="{{layer2Offset}}"
    width="{{layer2Size}}"
    height="{{layer2Size}}"
    rx="{{borderRadius}}"
    fill="{{accentColor}}"
    opacity="0.3"
    filter="url(#displace)"
    class="superposition-layer2 m4-optimized"
  />
  
  <!-- Layer 1 (primary layer) -->
  <rect
    x="{{layer1Offset}}"
    y="{{layer1Offset}}"
    width="{{layer1Size}}"
    height="{{layer1Size}}"
    rx="{{borderRadius}}"
    fill="url(#superpositionGradient)"
    filter="url(#glow-superposition)"
    class="superposition-layer1 quantum-pixel m4-optimized"
  />
  
  <!-- Position indicator lines -->
  <line
    x1="{{lineX1Start}}"
    y1="{{lineY1Start}}"
    x2="{{lineX1End}}"
    y2="{{lineY1End}}"
    stroke="{{accentColor}}"
    stroke-width="0.5"
    stroke-dasharray="2 1"
    opacity="0.6"
    class="position-line"
  />
  
  <line
    x1="{{lineX2Start}}"
    y1="{{lineY2Start}}"
    x2="{{lineX2End}}"
    y2="{{lineY2End}}"
    stroke="{{accentColor}}"
    stroke-width="0.5"
    stroke-dasharray="2 1"
    opacity="0.6"
    class="position-line"
  />
  
  <!-- Quantum state indicators -->
  <circle
    cx="{{quantum1X}}"
    cy="{{quantum1Y}}"
    r="{{quantumSize}}"
    fill="{{accentColor}}"
    class="quantum-indicator pulse-combined"
  />
  
  <circle
    cx="{{quantum2X}}"
    cy="{{quantum2Y}}"
    r="{{quantumSize}}"
    fill="{{secondaryAccentColor}}"
    class="quantum-indicator pulse-combined delay-sm"
  />
</svg>